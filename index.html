<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Ghosty Ultra-Deobfuscator</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&display=swap" rel="stylesheet">
<style>
    body { background: #000; color: #0ff; font-family: 'Orbitron', sans-serif; padding: 20px; text-align: center; }
    .box { max-width: 800px; margin: auto; background: #0a0a0a; padding: 20px; border: 2px solid #0ff; box-shadow: 0 0 20px #0ff; border-radius: 15px; }
    textarea { width: 100%; height: 150px; background: #111; border: 1px solid #0ff; color: #0ff; padding: 10px; margin: 10px 0; border-radius: 5px; font-family: monospace; }
    .btn { background: #0ff; color: #000; border: none; padding: 15px 30px; cursor: pointer; font-weight: bold; text-transform: uppercase; transition: 0.3s; width: 100%; }
    .btn:hover { background: #fff; box-shadow: 0 0 15px #fff; }
    .status { margin: 10px 0; font-size: 12px; color: #ff00ea; }
</style>
</head>
<body>

<div class="box">
    <h1>ULTRA UNPACKER</h1>
    <p style="font-size: 10px;">Paste the protected code below</p>
    
    <textarea id="input" placeholder="Paste full script here..."></textarea>
    
    <div class="status" id="log">Status: Waiting for input...</div>
    
    <button class="btn" onclick="ghostyUnpack()">Force Unlock</button>
    
    <textarea id="output" placeholder="Decoded source will appear here..." readonly></textarea>
    <button class="btn" style="background: #222; color: #0ff; margin-top: 10px;" onclick="copy()">Copy Result</button>
</div>

<script>
function ghostyUnpack() {
    let raw = document.getElementById('input').value;
    let log = document.getElementById('log');
    let out = document.getElementById('output');

    try {
        // 1. Extract the Base64 Part
        let b64 = "";
        if (raw.includes('"')) {
            b64 = raw.split('"')[1]; 
        } else if (raw.includes("'")) {
            b64 = raw.split("'")[1];
        } else {
            b64 = raw.trim();
        }

        // 2. Clean the string
        b64 = b64.replace(/\s/g, "").replace(/\\/g, "");

        // 3. Fix Base64 Padding (Crucial step to prevent "Invalid String" errors)
        while (b64.length % 4 !== 0) {
            b64 += "=";
        }

        // 4. Multi-Layer Decode
        let decoded = atob(b64);
        
        // 5. Handle UTF-8 / Percent Encoding
        try {
            decoded = decodeURIComponent(escape(decoded));
        } catch(e) {
            // If escape fails, keep the raw atob result
        }

        out.value = decoded;
        log.innerText = "SUCCESS: Code Restored.";
        log.style.color = "#0ff";
    } catch (err) {
        log.innerText = "CRITICAL ERROR: Data Corrupted or Missing Padding.";
        log.style.color = "#f00";
        console.error(err);
    }
}

function copy() {
    let o = document.getElementById('output');
    o.select();
    document.execCommand('copy');
    alert("Copied!");
}
</script>

</body>
</html>
